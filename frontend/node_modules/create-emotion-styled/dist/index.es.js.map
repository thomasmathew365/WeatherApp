{"version":3,"file":"index.es.js","sources":["../../emotion-theming/src/channel.js","../../emotion-theming/src/create-broadcast.js","../../emotion-theming/src/utils.js","../src/utils.js","../src/index.js"],"sourcesContent":["// @flow\nexport default '__EMOTION_THEMING__'\n","// @flow\n// https://github.com/styled-components/styled-components/blob/e05b3fe247e9d956bcde786cec376e32afb85bca/src/utils/create-broadcast.js\nconst createBroadcast = (initialState: any) => {\n  const listeners: { [number]: Function | void } = {}\n  let id = 0\n  let state = initialState\n\n  function publish(nextState: any) {\n    state = nextState\n\n    for (const key in listeners) {\n      // $FlowFixMe\n      const listener = listeners[key]\n      if (listener === undefined) {\n        continue\n      }\n\n      listener(state)\n    }\n  }\n\n  function subscribe(listener: any) {\n    const currentId = id\n    listeners[currentId] = listener\n    id += 1\n    listener(state)\n    return currentId\n  }\n\n  function unsubscribe(unsubID: number) {\n    listeners[unsubID] = undefined\n  }\n\n  return { publish, subscribe, unsubscribe }\n}\n\nexport default createBroadcast\n","// @flow\nimport PropTypes from 'prop-types'\nimport channel from './channel'\n\nexport const contextTypes = {\n  [channel]: PropTypes.object\n}\n\nexport { default as channel } from './channel'\nexport { default as createBroadcast } from './create-broadcast'\n\nexport type Theme = Object | ((theme: Object) => Object)\n","// @flow\nimport isPropValid from '@emotion/is-prop-valid'\nimport type { Interpolations } from 'create-emotion'\n\nexport function setTheme(theme: Object) {\n  this.setState({ theme })\n}\n\nexport const testPickPropsOnStringTag = isPropValid\n\nexport const testPickPropsOnComponent = (key: string) =>\n  key !== 'theme' && key !== 'innerRef'\nexport const testAlwaysTrue = () => true\n\nexport const pickAssign: (\n  testFn: (key: string) => boolean,\n  target: {},\n  ...sources: Array<{}>\n) => Object = function(testFn, target) {\n  let i = 2\n  let length = arguments.length\n  for (; i < length; i++) {\n    let source = arguments[i]\n    let key\n    for (key in source) {\n      if (testFn(key)) {\n        target[key] = source[key]\n      }\n    }\n  }\n  return target\n}\n\nexport type StyledOptions = {\n  e?: string,\n  label?: string,\n  target?: string,\n  shouldForwardProp?: (?string) => boolean\n}\n\ntype CreateStyledComponent = (...args: Interpolations) => *\n\ntype BaseCreateStyled = (\n  tag: any,\n  options?: StyledOptions\n) => CreateStyledComponent\n\nexport type CreateStyled = {\n  $call: BaseCreateStyled,\n  [key: string]: CreateStyledComponent\n}\n","// @flow\nimport type { Emotion, Interpolations } from 'create-emotion'\nimport { channel, contextTypes } from '../../emotion-theming/src/utils'\nimport type { ElementType } from 'react'\nimport typeof ReactType from 'react'\nimport type { CreateStyled, StyledOptions } from './utils'\nimport {\n  testPickPropsOnComponent,\n  testAlwaysTrue,\n  testPickPropsOnStringTag,\n  pickAssign,\n  setTheme\n} from './utils'\n\nfunction createEmotionStyled(emotion: Emotion, view: ReactType) {\n  let createStyled: CreateStyled = (tag, options) => {\n    if (process.env.NODE_ENV !== 'production') {\n      if (tag === undefined) {\n        throw new Error(\n          'You are trying to create a styled element with an undefined component.\\nYou may have forgotten to import it.'\n        )\n      }\n    }\n    let staticClassName\n    let identifierName\n    let stableClassName\n    let shouldForwardProp\n    if (options !== undefined) {\n      staticClassName = options.e\n      identifierName = options.label\n      stableClassName = options.target\n      shouldForwardProp =\n        tag.__emotion_forwardProp && options.shouldForwardProp\n          ? propName =>\n              tag.__emotion_forwardProp(propName) &&\n              // $FlowFixMe\n              options.shouldForwardProp(propName)\n          : options.shouldForwardProp\n    }\n    const isReal = tag.__emotion_real === tag\n    const baseTag =\n      staticClassName === undefined\n        ? (isReal && tag.__emotion_base) || tag\n        : tag\n\n    if (typeof shouldForwardProp !== 'function') {\n      shouldForwardProp =\n        typeof baseTag === 'string' &&\n        baseTag.charAt(0) === baseTag.charAt(0).toLowerCase()\n          ? testPickPropsOnStringTag\n          : testPickPropsOnComponent\n    }\n\n    return function() {\n      let args = arguments\n      let styles =\n        isReal && tag.__emotion_styles !== undefined\n          ? tag.__emotion_styles.slice(0)\n          : []\n      if (identifierName !== undefined) {\n        styles.push(`label:${identifierName};`)\n      }\n      if (staticClassName === undefined) {\n        if (args[0] == null || args[0].raw === undefined) {\n          styles.push.apply(styles, args)\n        } else {\n          styles.push(args[0][0])\n          let len = args.length\n          let i = 1\n          for (; i < len; i++) {\n            styles.push(args[i], args[0][i])\n          }\n        }\n      }\n\n      class Styled extends view.Component<*, { theme: Object }> {\n        unsubscribe: number\n        mergedProps: Object\n        static toString: () => string\n        static __emotion_real: any\n        static __emotion_styles: Interpolations\n        static __emotion_base: Styled\n        static __emotion_target: string\n        static __emotion_forwardProp: void | (string => boolean)\n        static withComponent: (ElementType, options?: StyledOptions) => any\n\n        componentWillMount() {\n          if (this.context[channel] !== undefined) {\n            this.unsubscribe = this.context[channel].subscribe(\n              setTheme.bind(this)\n            )\n          }\n        }\n        componentWillUnmount() {\n          if (this.unsubscribe !== undefined) {\n            this.context[channel].unsubscribe(this.unsubscribe)\n          }\n        }\n        render() {\n          const { props, state } = this\n          this.mergedProps = pickAssign(testAlwaysTrue, {}, props, {\n            theme: (state !== null && state.theme) || props.theme || {}\n          })\n\n          let className = ''\n          let classInterpolations = []\n\n          if (props.className) {\n            if (staticClassName === undefined) {\n              className += emotion.getRegisteredStyles(\n                classInterpolations,\n                props.className\n              )\n            } else {\n              className += `${props.className} `\n            }\n          }\n          if (staticClassName === undefined) {\n            className += emotion.css.apply(\n              this,\n              styles.concat(classInterpolations)\n            )\n          } else {\n            className += staticClassName\n          }\n\n          if (stableClassName !== undefined) {\n            className += ` ${stableClassName}`\n          }\n\n          return view.createElement(\n            baseTag,\n            // $FlowFixMe\n            pickAssign(shouldForwardProp, {}, props, {\n              className,\n              ref: props.innerRef\n            })\n          )\n        }\n      }\n      Styled.displayName =\n        identifierName !== undefined\n          ? identifierName\n          : `Styled(${\n              typeof baseTag === 'string'\n                ? baseTag\n                : baseTag.displayName || baseTag.name || 'Component'\n            })`\n\n      if (tag.defaultProps !== undefined) {\n        // $FlowFixMe\n        Styled.defaultProps = tag.defaultProps\n      }\n      Styled.contextTypes = contextTypes\n      Styled.__emotion_styles = styles\n      Styled.__emotion_base = baseTag\n      Styled.__emotion_real = Styled\n      Styled.__emotion_forwardProp = shouldForwardProp\n      Object.defineProperty(Styled, 'toString', {\n        enumerable: false,\n        value() {\n          if (\n            process.env.NODE_ENV !== 'production' &&\n            stableClassName === undefined\n          ) {\n            return 'NO_COMPONENT_SELECTOR'\n          }\n          // $FlowFixMe\n          return `.${stableClassName}`\n        }\n      })\n\n      Styled.withComponent = (\n        nextTag: ElementType,\n        nextOptions?: StyledOptions\n      ) => {\n        return createStyled(\n          nextTag,\n          nextOptions !== undefined\n            ? // $FlowFixMe\n              pickAssign(testAlwaysTrue, {}, options, nextOptions)\n            : options\n        )(...styles)\n      }\n\n      return Styled\n    }\n  }\n  if (process.env.NODE_ENV !== 'production' && typeof Proxy !== 'undefined') {\n    createStyled = new Proxy(createStyled, {\n      get(target, property) {\n        switch (property) {\n          // react-hot-loader tries to access this stuff\n          case '__proto__':\n          case 'name':\n          case 'prototype':\n          case 'displayName': {\n            return target[property]\n          }\n          default: {\n            throw new Error(\n              `You're trying to use the styled shorthand without babel-plugin-emotion.` +\n                `\\nPlease install and setup babel-plugin-emotion or use the function call syntax(\\`styled('${property}')\\` instead of \\`styled.${property}\\`)`\n            )\n          }\n        }\n      }\n    })\n  }\n  return createStyled\n}\n\nexport default createEmotionStyled\n"],"names":["contextTypes","channel","PropTypes","object","setTheme","theme","setState","testPickPropsOnStringTag","isPropValid","testPickPropsOnComponent","key","testAlwaysTrue","pickAssign","testFn","target","i","length","arguments","source","context","undefined","unsubscribe","subscribe","bind","property","Error","createEmotionStyled","emotion","view","createStyled","tag","options","process","env","NODE_ENV","staticClassName","identifierName","stableClassName","shouldForwardProp","__emotion_forwardProp","propName","e","label","isReal","__emotion_real","baseTag","__emotion_base","charAt","toLowerCase","args","styles","__emotion_styles","slice","push","raw","apply","len","props","state","mergedProps","className","classInterpolations","getRegisteredStyles","css","concat","createElement","innerRef","Styled","componentWillMount","componentWillUnmount","render","Component","displayName","name","defaultProps","defineProperty","withComponent","nextTag","nextOptions","Proxy"],"mappings":"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"}